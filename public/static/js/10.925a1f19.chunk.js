(this.webpackJsonpweb=this.webpackJsonpweb||[]).push([[10],{228:function(e,t,n){"use strict";n.r(t);var i=n(26),a=n(0),r=n.n(a),c=n(21),o=n(187),s=n(168),l=n(72),d=n(47),u=n.n(d),j=n(62),b=n(225),v=n(227),m=n(160),O=n(212),f=n(3),p=Object(o.a)((function(e){return{root:{display:"flex",justifyContent:"center",margin:"20px"},wrapper:{margin:e.spacing(1),position:"relative"},buttonProgress:{color:e.palette.secondary.main,position:"absolute",top:"50%",left:"50%",marginTop:-12,marginLeft:-12}}})),h=function(){var e=p(),t=Object(c.l)(),n=Object(i.a)(t,2)[1];return Object(f.jsx)(O.b,{initialValues:{friend:""},onSubmit:function(){var e=Object(j.a)(u.a.mark((function e(t,i){var a,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n({email:t.friend});case 2:r=e.sent,(null===(a=r.data)||void 0===a?void 0:a.invite.errors)?i.setErrors({friend:r.data.invite.errors[0].message}):i.setValues({friend:""}),i.setSubmitting(!1);case 5:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),children:function(t){var n=t.values,i=t.errors,a=t.handleChange,r=t.isSubmitting;return Object(f.jsx)(O.a,{children:Object(f.jsx)(b.a,{children:Object(f.jsxs)("div",{className:e.root,children:[Object(f.jsx)(v.a,{error:!!i.friend,id:"friend",name:"friend",label:"Friend's Email",helperText:i.friend,variant:"outlined",onChange:a,value:n.friend}),Object(f.jsxs)("div",{className:e.wrapper,children:[Object(f.jsx)(s.a,{variant:"contained",color:"secondary",disabled:r,type:"submit",children:"Invite"}),r&&Object(f.jsx)(m.a,{size:24,className:e.buttonProgress})]})]})})})}})},x=Object(o.a)((function(e){return{root:{display:"flex",justifyContent:"center",margin:"20px",flexDirection:"column",alignItems:"center"}}})),g=function(e){var t=e.status,n=x(),c=Object(a.useState)(0),o=Object(i.a)(c,2),d=o[0],u=o[1],j=null;return j=0===d||-1===t?Object(f.jsx)(r.a.Fragment,{children:Object(f.jsxs)("div",{className:n.root,children:[Object(f.jsx)(s.a,{onClick:function(){u(1)},disabled:-1===t,variant:"outlined",size:"small",color:"secondary",children:"Start New Game"}),Object(f.jsx)(l.a,{variant:"body2",children:-1===t?"Please Login to start the Game":""}),Object(f.jsxs)(l.a,{variant:"body1",align:"center",children:[Object(f.jsx)("br",{}),"You can send Invitation to your friend using Email, Please ask your friend to login once if he/she hasn't even once."]})]})}):Object(f.jsx)(r.a.Fragment,{children:Object(f.jsxs)(l.a,{variant:"h6",align:"center",children:["Invite Your Friend",Object(f.jsx)(h,{})]})}),Object(f.jsx)(r.a.Fragment,{children:j})},y=n(179),w=n.n(y),S=n(202),G=function(e){var t,n,r,o,s,d=e.currentGame,u=Object(c.e)(),j=Object(i.a)(u,1)[0],b=j.data,v=j.fetching,m=Object(c.o)(),O=Object(i.a)(m,1)[0].data,p=Object(c.j)(),h=Object(i.a)(p,2)[1];Object(c.g)({variables:{id:(null===O||void 0===O||null===(t=O.me)||void 0===t?void 0:t._id)||""}},(function(e,t){return(null===t||void 0===t?void 0:t.gameStarted)&&h(),t}));var x=Object(a.useState)(new S(!v&&(null===b||void 0===b||null===(n=b.currentGame)||void 0===n?void 0:n.lastPosition)||"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1")),g=Object(i.a)(x,1)[0],y=Object(a.useState)(g.fen()),G=Object(i.a)(y,2),P=G[0],N=G[1],k=Object(c.r)(),_=Object(i.a)(k,2)[1];Object(c.p)({variables:{id:(null===O||void 0===O||null===(r=O.me)||void 0===r?void 0:r._id)||""}},(function(e,t){if(t.move){console.log(t);var n=JSON.parse(t.move);g.move(n)&&setTimeout((function(){N(g.fen())}),300)}return t}));null===O||void 0===O||null===(o=O.me)||void 0===o||o.username;var C=(null===O||void 0===O||null===(s=O.me)||void 0===s?void 0:s._id)===d.white._id?"w":"b",I={username:"w"===C?d.black.username:d.white.username,playingAs:"w"===C?"b":"w"};return Object(f.jsxs)("div",{className:"flex-center",children:[Object(f.jsxs)(l.a,{variant:"h5",align:"center",style:{margin:"10px"},children:["You vs ",I.username]}),Object(f.jsx)(l.a,{variant:"h6",align:"center",style:{margin:"10px"},children:P.split(" ")[1]===C?"Your Turn":"Waiting for opponent to move"}),Object(f.jsx)(w.a,{width:400,position:P,onDrop:function(e){var t,n,i=!1;"w"===e.piece[0]&&(null===O||void 0===O||null===(t=O.me)||void 0===t?void 0:t._id)===d.white._id&&(i=!0),"b"===e.piece[0]&&(null===O||void 0===O||null===(n=O.me)||void 0===n?void 0:n._id)===d.black._id&&(i=!0),i&&function(e){if(g.move(e)){N(g.fen());var t=JSON.stringify(e);_({chessID:d._id,position:g.fen(),move:t})}}({from:e.sourceSquare,to:e.targetSquare,promotion:"q"})}})]})},P=Object(o.a)((function(e){return{root:{align:"center",display:"flex",justifyContent:"center",flexDirection:"column",alignItems:"center"},buttons:{margin:"10px 10px"}}})),N=function(){var e=Object(c.f)(),t=Object(i.a)(e,2)[1],n=P(),a=Object(c.e)(),o=Object(i.a)(a,1)[0],l=o.data,d=null;return o.fetching||void 0===(null===l||void 0===l?void 0:l.currentGame)||(d=Object(f.jsx)(r.a.Fragment,{children:Object(f.jsxs)("div",{className:n.root,children:[Object(f.jsx)(s.a,{onClick:function(){var e;t({chessID:(null===(e=l.currentGame)||void 0===e?void 0:e._id)||""})},variant:"outlined",size:"small",color:"secondary",children:"End Game"}),Object(f.jsx)(G,{currentGame:l.currentGame})]})})),Object(f.jsx)(r.a.Fragment,{children:d})},k=Object(o.a)((function(e){return{root:{display:"flex",justifyContent:"center",margin:"20px",flexDirection:"column",alignItems:"center"}}})),_=function(){var e=k(),t=Object(c.d)(),n=Object(i.a)(t,2)[1];return Object(f.jsxs)("div",{className:e.root,children:[Object(f.jsx)(l.a,{children:"Waiting for your friend to start the game..."}),Object(f.jsx)(s.a,{variant:"outlined",color:"secondary",size:"small",onClick:function(){return n()},children:"Cancel Invitation"})]})};t.default=function(){var e,t=Object(c.h)(),n=Object(i.a)(t,1)[0],a=n.data,o=n.fetching,s=null,l=Object(c.o)(),d=Object(i.a)(l,1)[0].data,u=Object(c.j)(),j=Object(i.a)(u,2)[1];return Object(c.g)({variables:{id:(null===d||void 0===d||null===(e=d.me)||void 0===e?void 0:e._id)||""}},(function(e,t){return(null===t||void 0===t?void 0:t.gameStarted)&&j(),t})),o||((null===a||void 0===a?void 0:a.GameStatus)&&0!==(null===a||void 0===a?void 0:a.GameStatus)&&-1!==(null===a||void 0===a?void 0:a.GameStatus)?1===a.GameStatus?s=Object(f.jsx)(_,{}):2===a.GameStatus&&(s=Object(f.jsx)(N,{})):s=Object(f.jsx)(g,{status:a?a.GameStatus:-1})),Object(f.jsx)(r.a.Fragment,{children:s})}}}]);
//# sourceMappingURL=10.925a1f19.chunk.js.map